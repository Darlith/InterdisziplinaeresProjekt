<!doctype html>
<html lang="de" layout:decorator="layout/validationHeader">
<head>
<title>Dashboard</title>
</head>

<body>
	<div class="content" layout:fragment="content">
		<div class="container-fluid">
			<div class="row" th:if="${analytics.processedOrders == 0}">
				<div class="col-md-12">
					<div class="card">
						<div class="card-header card-header-icon"
							 data-background-color="rose">
							<i class="material-icons">warning</i>
						</div>
						<div class="card-content">
							<h4 class="card-title">Achtung</h4>
							<p>Es sind nicht genug Bestellungen verarbeitet worden, um Auswertungen anzufertigen.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-lg-3 col-md-6 col-sm-6">
					<div class="card card-stats">
						<div class="card-header" data-background-color="orange">
							<i class="material-icons">shopping_cart</i>
						</div>
						<div class="card-content">
							<p class="category">Verarbeitete Bestellungen</p>
							<h3 class="card-title" th:text="${analytics.processedOrders}"></h3>
						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6">
					<div class="card card-stats">
						<div class="card-header" data-background-color="rose">
							<i class="material-icons">access_time</i>
						</div>
						<div class="card-content">
							<p class="category" >Durchschnittliche Lieferzeit (Minuten)</p>
							<h3 class="card-title" th:text="${#numbers.formatDecimal(analytics.averageFlightTime, 1, 2)}"></h3>
						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6">
					<div class="card card-stats">
						<div class="card-header" data-background-color="blue">
							<i class="material-icons">timer</i>
						</div>
						<div class="card-content">
							<p class="category">Versp√§tungsquote</p>
							<h3 class="card-title" th:text="${#numbers.formatDecimal(analytics.delayedQuote, 1, 2)} + '%'"></h3>
						</div>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6">
					<div class="card card-stats">
						<div class="card-header" data-background-color="green">
							<i class="material-icons">flight</i>
						</div>
						<div class="card-content">
							<p class="category">Drohnen im Einsatz</p>
							<h3 class="card-title" th:text="${analytics.droneCount}"></h3>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<div class="card" style="height: 400px;">
						<div class="card-header card-header-icon"
							data-background-color="rose">
							<i class="material-icons">add_location</i>
						</div>
						<div class="card-content">
							<h4 class="card-title">Belieferte Orte</h4>
							<div id="map_canvas" class="map"></div>
							<p><strong>Legende:</strong> Rot: Lagerhalle | Blau: Belieferte Orte</p>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
<script type="text/javascript" layout:fragment="selfScripts" th:inline="javascript">
    //<![CDATA[
    $(document).ready(function () {
        var analyticsData = [[${analytics}]];

        initMap();

        function initMap() {
            var salcombe = {
                lat: 50.23758,
                lng: -3.769791
            };
            var map = new google.maps.Map(document.getElementById('map_canvas'), {
                zoom: 11,
                center: salcombe
            });
            var markers = analyticsData.coordinates;
            for(var i in markers) {
                var obj = markers[i];
                var marker = new google.maps.Marker({
                    position: {lat: obj.latitude, lng: obj.longitude},
                    icon: 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png',
                    map: map
                });
			};
            var marker = new google.maps.Marker({
                position: salcombe,
                map: map
            });
        }

    });

    //]]>
</script>

</html>